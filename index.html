<head></head>
    <script src='MicrosoftTeams.min.js'></script>
</head>
<body>
    <button id="gray" onclick="(document.getElementById('icon').src = '/images/iconGray.png'); colorClickGray()">Select Gray</button>

    <script>
        microsoftTeams.app.initialize();
        let saveGray = () => {
            microsoftTeams.pages.config.registerOnSaveHandler((saveEvent) => {
                const configPromise = microsoftTeams.pages.config.setConfig({
                    websiteUrl: "https://detect-request-teams-app.herokuapp.com/",
                    contentUrl: "https://detect-request-teams-app.herokuapp.com/",
                    entityId: "grayIconTab",
                    suggestedDisplayName: "MyNewTab"
                });
                configPromise.
                    then((result) => {saveEvent.notifySuccess()}).
                    catch((error) => {saveEvent.notifyFailure("failure message")});
            });
        }
        let gr = document.getElementById("gray").style;

        const colorClickGray = () => {
            microsoftTeams.pages.config.setValidityState(true);
            saveGray()
        }

    </script>
</body>