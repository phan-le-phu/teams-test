<head></head>
    <script src='MicrosoftTeams.min.js'></script>
</head>
<body>
    <button id="gray" onclick="configClick()">Select config</button>

    <script>
        microsoftTeams.app.initialize();
        let setConfig = () => {
            microsoftTeams.pages.config.registerOnSaveHandler((saveEvent) => {
                const configPromise = microsoftTeams.pages.config.setConfig({
                    websiteUrl: "https://detect-request-teams-app.herokuapp.com/",
                    contentUrl: "https://detect-request-teams-app.herokuapp.com/",
                    entityId: "grayIconTab",
                    suggestedDisplayName: "MyNewTab"
                });
                configPromise.
                    then((result) => {saveEvent.notifySuccess()}).
                    catch((error) => {saveEvent.notifyFailure("failure message")});
            });
        }

        const configClick= () => {
            microsoftTeams.pages.config.setValidityState(true);
            setConfig();
        }

    </script>
</body>